\documentclass[presentation]{beamer}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usetheme{default}
\author{Sergi Simón Balcells}
\date{2025/04/01}
\title{Introduction to lattice-based postquantum Cryptography}
\subtitle{\#ProyectosCiber}
\makeatletter
\newlength\beamerleftmargin
\setlength\beamerleftmargin{\Gm@lmargin}
\makeatother
\begin{document}

\begin{frame}
  \titlepage
  \begin{figure}
    \hspace*{-\beamerleftmargin}%
    \includegraphics[width=\paperwidth]{incibe.jpg}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Acknowledgements}
  
Esta investigación resulta del Proyecto Estratégico 'Avances en criptografía post-cuántica aplicados al desarrollo de un sistema de cupones' (C039/24), fruto del convenio de colaboración suscrito entre el Instituto Nacional de Ciberseguridad (INCIBE) y la Universidad de Lleida. Esta iniciativa se realiza en el marco de los fondos del Plan de Recuperación, Transformación y Resiliencia, financiados por la Unión Europea (Next Generation).
\end{frame}


\AtBeginSection[]{
  \begin{frame}{Outline}
    \tableofcontents[currentsection]
  \end{frame}
}
\section{Preliminaries}

\begin{frame}[label=lattice]{Lattice}
  Let \(B = \{b_1, b_2, \dots, b_m\}\), be a set of linear
  independent
  vectors on \(\mathcal R ^ n\). Then:

  \[
    L(B) = \{\sum_i a_i b_i | a_i \in \mathbb Z \}
  \]
  is called a lattice generated by \(B\). \(B\) is the base.

  Note that \(B\) can be seen as a matrix \(B = (b_1, b_2,
  \dots, b_m)\)
  so:
  \[
    L(B) = \{Ba | a \in \mathbb Z^{n} \}
  \]
\end{frame}
\begin{frame}[label=short-vector-problem]{Short Vector Problem}
  \[
    Ba = \lambda(L)
  \]

  Where \(\lambda (L)\) is the smallest vector and and \(a\)
  is a non-zero
  vector.

  This problem is NP-hard \cite{original-ajtai}.
\end{frame}
\begin{frame}[label=short-integer-solution]
  \frametitle{Short Integer Solution}
  Solve:
  \[
    As = 0
  \]

  Or more generaly:
  \[
    As = v
  \]
  Where \(||s||\) is small.

  The average case on this problem translates to a hard case
  of SVP.

  \cite{original-ajtai} proved this and used it as a one-time-hash protocol.
\end{frame}
\begin{frame}[label=a-ring-approach]{A Ring Approach}
  For this problem to be hard, it needs large key sizes.

  FrodoKEM \cite{FrodoKEM} uses up to 22kB just for the public key.

  So, we change the base Ring from \(\mathbb Z_p\) to
  \(\mathcal R = \mathbb Z_q[x] / f(x)\) \cite{ring-sis, ring-lwe-1,ring-lwe-2}.
  \pause

  To get the norm, we use the coefficient between 
  $\frac{-q}{2}$ to $\frac{q}{2}$
\end{frame}
\begin{frame}[label=limitations-of-ring-approach]
  \frametitle{Limitations of Ring Approach}
  The huge adventage with Rings is the computational gains of NTT
  multiplications.

  They add constraints to the key that limit the security
  parameters harshly.

  One way to solve it is to construct a matrix of smaller ring
  elements, but it is not always possible.

\end{frame}
\section{Case of Study: Falcon}
\begin{frame}[label=the-ring]{The Ring}
  The Ring on Falcon \cite{falcon20} is
  \[
    \mathcal R = Z_q[x] / \phi
  \]
  Where \(\phi = x^n + 1\), \(n\) is a power of \(2\) and 
  \(q = kn + 1\) and is prime.

  This lets the NTT to have an optimal performance. 
\end{frame}
\begin{frame}[label=the-trapdoor]{The trapdoor}
  Falcon creates a polynomial:
  \[
    fG - gF = q \; \text({mod } \;\phi \text{)}
  \]
  And constructs:
  \[
    h = gf^{-1}
  \]

  The public key is 
  $A = \left[ \begin{array}{r|l} 1 &h\end{array} \right]$

  The secret basis is an orthogonal basis:
  \[
    B = \left[
      \begin{array}{r | l}
        g &-f\\
        \hline
        G &-F
      \end{array}
    \right]
  \]

\end{frame}

\begin{frame}[label=the-idea]{The idea}

  The idea is to solve \(As' = v\) for some large \(s'\), and
  then use notion orthogonal basis to create a similar vector of
  \(s'\) s.t.  \(A(s' -Bw) = v\) and \(||s' - Bw||_2\) is small.

\end{frame}
\begin{frame}[label=problems]{Problems}

  The creation of \(s\) is random, so given the same vector
  it \alert{can} output different solutions (\(s_1, s_2\)
  s.t. \(As_i = v\) ).

  With enough of these solutions one can create a trapdoor.

  There are two solutions on this:

  \begin{itemize}
    \item De-randomizing
    \item Adding your own random element.
  \end{itemize}

  Falcon uses the second, so it signs \(As = H(m || r)\)

\end{frame}

\section{LWE Variant}
\begin{frame}[label=lwe-variant]{LWE variant}

  We base our security on \cite{lwe-problem}:
  \[
    As + e = b
  \]
  Is hard to solve for vectors $s$ and $e$ with small norm.

  As before, using rings provide better speed-ups with 
  smaller key-sizes, \alert{but} they are more sensible 
  to the error distribution. \pause

  Intuition:
  \[
    (A \; I_n \;-b)\cdot \left( 
      \begin{array}{c}
        s 
        \\e 
        \\1 
      \end{array}
    \right) = 0 \text{ (mod $q$) }
  \]
\end{frame}
\begin{frame}[label=rounding]
  \frametitle{Rounding elements}
  We round the elements if that are close to $0$ to 0:
  \begin{equation}
    \lfloor x \rceil = \begin{cases}
      0 &\text{ if } -\cfrac{q}{4} \leq x < \cfrac{q}{4} \\
      \\
      1 &\text{ otherwise}
    \end{cases} \qquad
  \end{equation}
\end{frame}
\begin{frame}[label=security-errors-and-how-to-avoid-them]
  \frametitle{Security errors and how to avoid them}
  The error must be equivalent to a continuous spherical Guassian
  distribution of $r \geq 2$ \cite{how-not-to-instantiate}.

  In discrete terms is better to use a Centered Binomial
  Distribution of parameter $n$. This corresponds to $2n$ 
  toss coins ($n = 2$):
  \[
    \sum a_i - \sum b_i = a_0 + a_1 - b_0 - b_1
  \]
  This is easier to derandomize.
  \pause

  There is an estimator \cite{lattice-estimator} to check the
  security bits of a protocol.
\end{frame}

\section{Kyber and Dilithium}
\begin{frame}[label=a-gentle-introduction-to-kyber]
  \frametitle{A gentle introduction to Kyber}
  The public key is:
  \[
    As + e = b
  \]
  To pass a binary message $m$ to a Ring element 
  \texttt{toRing($m$)}, treat each bit as a coefficient and
  multiply it by $\frac{q}{2}$.
  \pause

  Example: $m = 0110$:
  \[
  \texttt{toRing}(m) = 0x^3 + \frac{q}{2}x^2 + \frac{q}{2}x + 0
  \]

\end{frame}
\begin{frame}
  \frametitle{The Protocol}
  \begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{kyber.png}
    \caption{Activity diagram of Kyber \cite{kyber-spec}}
  \end{figure}
\end{frame}
\begin{frame}
  \frametitle{Why?}
  \begin{equation}
    \begin{array}{rl}
      m^* &= v - s^T u \\
      m^* &= b^T r + e_2 + m' - s^T(A^T r + e_1) \\
      m^* &= (As+e)^Tr + e_2 + m' - s^TA^Tr - s^Te_1 \\
      m^* &= s^TA^Tr + e^Tr + e_2 + m'  - s^TA^Tr - s^Te_1 \\
      m^* &= m' + e'
    \end{array}
  \end{equation}

  And rounding just deletes the error with a probability of
  failure of $2^{-128}$

\end{frame}
\begin{frame}[label=a-gentle-introduction-to-dilithium]
  \frametitle{A gentle introduction to Dilithium}
  Signature creation \cite{dilithium-spec}:
  \begin{enumerate} 
    \item $w = \lfloor Ay \rceil$
    \item $c = H(m || w)$, $c \in \mathcal R$ <<and small>>.
    \item $z = y + cs$ and perform \alert{rejection sampling}.
  \end{enumerate}
  The signature is $\sigma = (z, c)$
  \pause

  Check signature:
  \[w' = \lfloor Az - bc \rceil \]
  \[c' = H(m || w') \]
  Then check:
  \[c = c'\]
\end{frame}

\section{NIZK}
\begin{frame}[label=non-interactive-zero-knowledge-proof]
  \frametitle{Example of a Non-Interactive Zero Knowledge Proof}
% NOTE: Que he de posar? 
%  1. He d'ensenyar la creació d'un sistema lineal
%  2. Hauria de quedar clar que es pot extendre a les necessitats
%     que convinguin

  Given the system \cite{nizk}:
  \begin{equation*}
    \begin{array}{rl}
      B_0r_0 &= As - B_1r_1 \\
      e &= E r_1
    \end{array}
  \end{equation*}

  \begin{enumerate}
    \item Generate $y_0$ $y_1$ small such as:
      \begin{equation*}
        \begin{array}{rl}
          w  &= Ay_0 - B_1y_1 \\
          e' &= E y_1
        \end{array}
      \end{equation*}
    \item Compute a challenge $c = \mathcal H (w, e')$ where
      $c \in \mathcal R$
    \item Compute:
      \begin{equation*}
        \begin{array}{rl}
          z_0 &= y_0 + cs \\
          z_1 &= y_1 + cr_1 \\
        \end{array}
      \end{equation*}
    \item Perform a rejection sampling algorithm on $z$, 
      so the secret cannot be retrieved.
  \end{enumerate}
\end{frame}

\begin{frame}
  \frametitle{NIZK acceptance}

  Check:
  \begin{equation*}
    \begin{array}{rl}
      w + cB_0r_0 &= Az_0 - B_1z_1 \\
      e' + ce &= E z_1
    \end{array}
  \end{equation*}
  And all $||z_i|| \leq \beta$.
\end{frame}

\begin{frame}
  \huge{Thanks for your attention}
\end{frame}
\begin{frame}[allowframebreaks]
  \frametitle{References}
  \bibliographystyle{apalike}
  \bibliography{bib}
\end{frame}
\end{document}

